name: deployment to server
run-name: ðŸš€ ${{ github.event.head_commit.message }} deployment triggered by ${{ github.actor }} ðŸš€
on:
  push:
    branches:
    - main
jobs:
  deploy-stage:
    runs-on: ubuntu-latest
    timeout-minutes: 3
    steps:
      - run: echo "Preparing deploy-stage environment ðŸ”§"
      - name: Prepare ssh tunnel to the server for the deployment
        uses: kielabokkie/ssh-key-and-known-hosts-action@v1
        with:
          ssh-private-key: ${{ secrets.SSH_GITHUB_ACTION }}
          ssh-host: ${{ secrets.SERVER_IP }}
      - name: Pull repository
        run: ssh root@${{ secrets.SERVER_IP }} "git -C /app pull"
      - name: 
        run: ssh root@${{ secrets.SERVER_IP }} "npm --prefix /app install && npm --prefix /app run build"
        # restart http-server
      
